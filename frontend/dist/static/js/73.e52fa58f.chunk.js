"use strict";(self.webpackChunksrc=self.webpackChunksrc||[]).push([[73],{1385:(e,t,r)=>{r.d(t,{A:()=>a});r(9950);const a=r.p+"static/media/xmark-solid.33c889ee6afa3ed57684011608af6238.svg"},3202:(e,t,r)=>{r.d(t,{l:()=>o});r(9950);const a=r.p+"static/media/rss-solid.167813b1d681372ed1d98e45b6b6c0f7.svg";const n=r.p+"static/media/link-solid.49819f951200a220d9839699fbccd8de.svg";const l=r.p+"static/media/link-slash-solid.7893b9a51ad07ceedeb88c9649c58439.svg";var s=r(4414);const o=e=>{const{content:t,title:r,type:o,className:c}=e;let i="";switch(o){case"success":i="from-green-400 to-blue-500";break;case"warning":i="from-orange-400 to-orange-600";break;case"error":i="from-red-400 to-red-600"}return(0,s.jsx)("div",{className:"my-2 shadow-xl p-6 text-sm text-white rounded-lg bg-gradient-to-r ".concat(i," ").concat(null!==c&&void 0!==c?c:""),children:(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,s.jsxs)("div",{className:"flex gap-2 font-bold text-lg",children:[(0,s.jsx)("img",{className:"success"===o?"size-6":"hidden",src:a,alt:""}),(0,s.jsx)("img",{className:"warning"===o?"size-6":"hidden",src:n,alt:""}),(0,s.jsx)("img",{className:"error"===o?"size-6":"hidden",src:l,alt:""}),(0,s.jsx)("span",{children:r})]}),(0,s.jsx)("span",{className:"pl-3 text-md font-medium",children:t.split("\n").map((e=>(0,s.jsxs)("p",{children:[e,(0,s.jsx)("br",{})]},e)))})]})})}},5242:(e,t,r)=>{r.d(t,{$:()=>n});var a=r(4414);const n=e=>{const{className:t,label:r,onClick:n}=e;return(0,a.jsx)("button",{className:"w-full text-white font-medium text-sm shadow-lg rounded-lg py-2 ".concat(null!==t&&void 0!==t?t:""),onClick:n,children:r})}},88:(e,t,r)=>{r.d(t,{t:()=>u});var a=r(9950),n=r(3461),l=r.n(n),s=r(1274),o=r(9027),c=r.n(o),i=r(7818),d=r(4414);const u=(0,a.forwardRef)(((e,t)=>{const r=.65*window.devicePixelRatio,{boost:n,title:o,series:u,height:h,legend:m,tooltip:f,zooming:b,animation:p,lineWidth:g,tickInterval:v,tickPrecision:x,lineColor:w,backgroundColor:y}=e,[S,A]=(0,a.useState)(!1);(0,a.useEffect)((()=>{A((()=>{if(window.WebGLRenderingContext){const e=document.createElement("canvas");return["webgl","experimental-webgl","webgl2","moz-webgl","webkit-3d"].some((t=>{try{return!!e.getContext(t)}catch(r){return!1}}))}return!1})())}),[]);const[C,E]=(0,a.useState)({chart:{zooming:b?{type:"x"}:{},marginTop:20,height:h,animation:p,backgroundColor:y},xAxis:{labels:{style:{color:"#fff"},format:"{value:%H:%M:%S}"},type:"datetime",tickColor:"#fff",lineColor:w},yAxis:{labels:{style:{color:"#fff"},format:x?"{value:".concat(x,"f}"):"{value:0.2f}"},title:{text:""},opposite:!0,lineColor:w,tickInterval:v},tooltip:{enabled:f,followPointer:!0,followTouchMove:!0,xDateFormat:"%Y-%m-%d %H:%M:%S",padding:12},legend:{enabled:m,itemStyle:{color:"#fff"}},plotOptions:{series:{lineWidth:g,turboThreshold:n?10:0,boostThreshold:n?1:0,states:{hover:{enabled:!1}}}},title:{text:o,style:{color:"#fff",fontSize:"10px",fontWeight:"normal"}},boost:{enabled:S,pixelRatio:r},accessibility:{enabled:!1},credits:{enabled:!1},time:{useUTC:!1},series:[u]}),{t:j}=(0,i.Bd)();return(0,a.useEffect)((()=>{c()(l())}),[]),(0,a.useEffect)((()=>{l().setOptions({lang:{resetZoom:j("components.chart.reset_zoom"),resetZoomTitle:j("components.chart.reset_zoom_title")}})}),[j]),(0,a.useEffect)((()=>{E((e=>({...e,chart:{...e.chart,height:h},title:{...e.title,text:o},boost:{...e.boost,enabled:S}})))}),[h,o,S]),(0,d.jsx)(s.HighchartsReact,{ref:t,options:C,highcharts:l()})}))},3768:(e,t,r)=>{r.d(t,{h:()=>c,R:()=>i});var a=r(9950);const n=r.p+"static/media/square-caret-up-solid.0573794ec033f5ce25c1076e3ac596e3.svg";const l=r.p+"static/media/ellipsis-solid.e3aced2a80c2b888104322b1ae60b47f.svg";var s=r(1385),o=r(4414);let c=function(e){return e[e.COLLAPSE_DISABLE=0]="COLLAPSE_DISABLE",e[e.COLLAPSE_SHOW=1]="COLLAPSE_SHOW",e[e.COLLAPSE_HIDE=2]="COLLAPSE_HIDE",e}({});const i=e=>{const{label:t,text:r,children:i,collapse:d,advanced:u}=e,[h,m]=(0,a.useState)(!1),[f,b]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=d||c.COLLAPSE_DISABLE;m(e===c.COLLAPSE_HIDE)}),[d]);const p=(d||c.COLLAPSE_DISABLE)!==c.COLLAPSE_DISABLE;return(0,o.jsxs)("div",{className:"mb-4 flex flex-col rounded-xl text-gray-700 shadow-lg",children:[(0,o.jsx)("div",{className:"mx-4 rounded-lg overflow-hidden shadow-lg",children:i}),(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsxs)("h6",{className:"text-md font-bold text-gray-800 flex ".concat(p?"cursor-pointer select-none":""),onClick:()=>p&&m(!h),children:[p&&(0,o.jsx)("img",{className:"mx-1 ".concat(h?"rotate-180":""),src:n,alt:""}),t]}),r&&!h&&(0,o.jsx)("div",{className:"text-md pt-2",children:r.split("\n").map((e=>(0,o.jsx)("div",{children:e},e)))}),u&&(0,o.jsxs)("div",{className:"mt-2 space-y-2 ".concat(h?"hidden":"block"),children:[(0,o.jsxs)("div",{className:"mx-1 cursor-pointer",onClick:()=>b(!f),children:[(0,o.jsx)("img",{className:"size-4 ".concat(f?"hidden":"block"),src:l,alt:""}),(0,o.jsx)("img",{className:"size-4 ".concat(f?"block":"hidden"),src:s.A,alt:""})]}),(0,o.jsx)("div",{className:f?"block":"hidden",children:u})]})]})]})}},7780:(e,t,r)=>{r.d(t,{p:()=>s});var a=r(9925),n=r(4628),l=r(4414);const s=e=>{const{label:t,disabled:r,className:s,defaultValue:o,numberLimit:c,type:i,onValueChange:d}=e,u=(0,n.M)((e=>{let{target:t}=e;if(!d)return;const{value:r}=t;if("number"===i){const e=Number(r);if(isNaN(e))return t.value=o.toString(),void d(o);if(c){const{max:r,min:a}=c;if(e>r||e<a)return t.value=o.toString(),void d(o)}d(e)}else d(r)}),1e3);return(0,l.jsx)(a.A,{size:"small",type:i,label:t,disabled:r,onChange:u,defaultValue:o,className:"w-full ".concat(null!==s&&void 0!==s?s:""),InputLabelProps:{shrink:!0}})}},898:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(4414);const n=e=>{const{embedded:t,className:r,label:n,sublabel:l,children:s}=e;return(0,a.jsx)("div",{className:"w-full text-gray-800",children:(0,a.jsxs)("div",{className:"flex flex-col shadow-lg rounded-lg",children:[(0,a.jsxs)("div",{className:"px-4 py-3 font-bold",children:[l&&(0,a.jsx)("h6",{className:"text-gray-500 text-xs",children:l}),(0,a.jsx)("h2",{className:t?"text-md":"text-lg",children:n})]}),(0,a.jsx)("div",{className:"p-4 m-2 flex flex-col justify-center gap-4 ".concat(null!==r&&void 0!==r?r:""),children:s})]})})}},3740:(e,t,r)=>{r.d(t,{w:()=>n});var a=r(5887);const n=function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a.Ay.error(e,{duration:t}):a.Ay.success(e,{duration:t})}},8418:(e,t,r)=>{r.d(t,{U:()=>a});const a=(e,t)=>{const r=[];for(let a=0;a<e.length;a++)a?r.push((e[a]-e[a-1])/(t/1e3)):r.push(0);return r}},7678:(e,t,r)=>{r.d(t,{W:()=>l,z:()=>n});var a=r(6004);let n=function(e){return e[e.LOW_PASS=0]="LOW_PASS",e[e.HIGH_PASS=1]="HIGH_PASS",e[e.BAND_PASS=2]="BAND_PASS",e}({});const l=(e,t)=>{const{passbandType:r,poles:l,sampleRate:s,lowFreqCorner:o,highFreqCorner:c}=t;let i;i=r===n.LOW_PASS?a.com.oregondsp.signalProcessing.filter.iir.PassbandType.LOWPASS:r===n.HIGH_PASS?a.com.oregondsp.signalProcessing.filter.iir.PassbandType.HIGHPASS:a.com.oregondsp.signalProcessing.filter.iir.PassbandType.BANDPASS;const d=new a.com.oregondsp.signalProcessing.filter.iir.Butterworth(l,i,o,c,1/s),u=new Float32Array(e);return d.filterInPlace(u),Array.from(u)}},6969:(e,t,r)=>{r.d(t,{N:()=>a});const a=(e,t)=>{const r=[];for(let a of e)r.push(a/t);return r}},7156:(e,t,r)=>{r.d(t,{i:()=>a});const a=(e,t,r)=>{const a=2**(t-1),n=[];for(let l of e)n.push(r/a*l);return n}},2105:(e,t,r)=>{r.d(t,{D:()=>n});var a=r(3974);const n=e=>{const t=new Date(e);return(0,a.A)(t,"yyyy-MM-dd HH:mm:ss")}},4628:(e,t,r)=>{r.d(t,{M:()=>a});const a=(e,t)=>{let r=null;return function(){for(var a=arguments.length,n=new Array(a),l=0;l<a;l++)n[l]=arguments[l];null===r&&(r=window.setTimeout((()=>(r=null,e(...n))),t))}}},8073:(e,t,r)=>{r.r(t),r.d(t,{default:()=>E});var a=r(5297),n=r(3768),l=r(3202),s=r(9950),o=r(88),c=r(7818),i=r(1577);var d=r(3740),u=r(2105),h=r(9145),m=r(7254);var f=r(7156),b=r(6969),p=r(8418),g=r(7678);var v=r(5242),x=r(4339);const w=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=(0,s.useRef)(e),a=(0,s.useRef)();(0,s.useEffect)((()=>{const e=()=>{r.current&&(a.current=(e=>{let{backend:t,endpoint:r,onOpen:a,onData:n,onClose:l,onError:s}=e;try{if("socket"!==r.type)throw new Error("non-websocket protocol is not supported");const e=(0,x.J)(!1),o="".concat(e,"//").concat(t).concat(r.path),c=new WebSocket(o);return c.onmessage=e=>{const t=JSON.parse(e.data);n({...e,data:t})},c.onopen=a||(()=>{}),c.onclose=l||(()=>{}),c.onerror=s||(()=>{}),c}catch{return null}})({...r.current,onClose:n=>{var l,s;a.current=null,null===(l=r.current)||void 0===l||null===(s=l.onClose)||void 0===s||s.call(l,n),t&&setTimeout((()=>e()),1e3)},onError:n=>{var l,s;a.current=null,null===(l=r.current)||void 0===l||null===(s=l.onError)||void 0===s||s.call(l,n),t&&setTimeout((()=>e()),1e3)}}))};return e(),()=>{var e;null===(e=a.current)||void 0===e||e.close(),r.current=null}}),[t])};var y=r(898),S=r(7780),A=r(4628),C=r(4414);const E=()=>{const{t:e}=(0,c.Bd)(),[t,r]=(0,s.useState)({type:"warning",title:"views.realtime.banner.warning.label",content:"views.realtime.banner.warning.text"}),[x,E]=(0,s.useState)({ehz:{holder:{collapse:n.h.COLLAPSE_HIDE,label:"views.realtime.charts.ehz.label",text:"views.realtime.charts.ehz.text",values:{pga:"0.00000",pgv:"0.00000",intensity:"-"}},chart:{buffer:[],backgroundColor:"#d97706",filter:{enabled:!1},ref:(0,s.useRef)(null),series:{name:"EHZ",type:"line",color:"#f1f5f9"}}},ehe:{holder:{collapse:n.h.COLLAPSE_HIDE,label:"views.realtime.charts.ehe.label",text:"views.realtime.charts.ehe.text",values:{pga:"0.00000",pgv:"0.00000",intensity:"-"}},chart:{buffer:[],filter:{enabled:!1},backgroundColor:"#10b981",ref:(0,s.useRef)(null),series:{name:"EHE",type:"line",color:"#f1f5f9"}}},ehn:{holder:{collapse:n.h.COLLAPSE_HIDE,label:"views.realtime.charts.ehn.label",text:"views.realtime.charts.ehn.text",values:{pga:"0.00000",pgv:"0.00000",intensity:"-"}},chart:{buffer:[],backgroundColor:"#0ea5e9",filter:{enabled:!1},ref:(0,s.useRef)(null),series:{name:"EHE",type:"line",color:"#f1f5f9"}}}}),j=()=>r({type:"error",title:"views.realtime.banner.error.label",content:"views.realtime.banner.error.text"});w({backend:i.DR.backend,endpoint:i.DR.endpoints.socket,onData:e=>{let{data:t}=e;return async function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.forEach((t=>t(e)))}(t,(e=>((e,t)=>{var r,a;if(!e.ts)return;const{scale:n}=m.A.getState().scale,l=null!==(r=null===(a=h.c.scales.find((e=>e.property().value===n)))||void 0===a?void 0:a.property().name)&&void 0!==r?r:"Unknown",s=(0,u.D)(e.ts),o=Object.values(e).filter((e=>Array.isArray(e))),c=(o.reduce(((e,t)=>e+t.length),0)/o.length).toFixed(0);t((e=>({...e,type:"success",title:"views.realtime.banner.success.label",content:"views.realtime.banner.success.text",values:{sampleRate:c,time:s,scale:l}})))})(e,r)),(e=>{return r=E,void((t=e).ts&&r((e=>{const{ts:r,...a}=t,{retention:n}=m.A.getState().retention;return Object.keys(e).forEach((l=>{var s;if(!(l in t))return;const o=a[l],{buffer:c}=e[l].chart;c.push({ts:r,data:o});const i=r-1e3*n;for(;c[0].ts<i;)c.shift();const{enabled:d,lowCorner:u,highCorner:v}=e[l].chart.filter,{lowFreqCorner:x,highFreqCorner:w}={lowFreqCorner:null!==u&&void 0!==u?u:.1,highFreqCorner:null!==v&&void 0!==v?v:10};e[l].chart={...e[l].chart,title:d?"Band pass [".concat(x.toFixed(1),"-").concat(w.toFixed(1)," Hz]"):""};const y=c.map((e=>{let{ts:t,data:r}=e;const a=d?(0,g.W)(r,{poles:4,lowFreqCorner:x,highFreqCorner:w,sampleRate:r.length,passbandType:g.z.BAND_PASS}):r,n=1e3/a.length;return a.map(((e,r)=>[t-n*(a.length-r),e]))})).reduce(((e,t)=>e.concat(t)),[]),{current:S}=e[l].chart.ref;if(S){const{series:e}=S.chart;e[0].setData(y,!0,!1,!1)}const{adc:A}=m.A.getState().adc,C=(0,f.i)(o,A.resolution,A.fullscale),{geophone:E}=m.A.getState().geophone,j=E[l],N=(0,b.N)(C,j),k=1e3/o.length,L=(0,p.U)(N,k),{scale:P}=m.A.getState().scale,_=null!==(s=h.c.scales.find((e=>e.property().value===P)))&&void 0!==s?s:h.R,{holder:O}=e[l];O.values={pga:L.reduce(((e,t)=>Math.max(Math.abs(e),Math.abs(t))),0).toFixed(5),pgv:N.reduce(((e,t)=>Math.max(Math.abs(e),Math.abs(t))),0).toFixed(5),intensity:"".concat(P," ").concat(_.getIntensity({rawData:o,currentPGV:Math.max(...N),currentPGA:Math.max(...L)},{adc:A,geophone:E}))}})),e})));var t,r}))},onError:j,onClose:j,onOpen:()=>(0,d.w)(e("views.realtime.toasts.websocket_connected"))});const[N,k]=(0,s.useState)(150),L=(0,s.useCallback)((()=>{let e=Math.round(.6*window.innerHeight/Object.keys(x).length);e<150?e=150:e>500&&(e=500),k(e)}),[x]),P=(0,A.M)((()=>L()),2e3);(0,s.useEffect)((()=>(L(),window.addEventListener("resize",P),()=>window.removeEventListener("resize",P))),[L,P]);const _=(e,t,r)=>E((a=>({...a,[e]:{...a[e],chart:{...a[e].chart,filter:{...a[e].chart.filter,[t?"lowCorner":"highCorner"]:r}}}})));return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(l.l,{type:t.type,title:e(t.title,{...t.values}),content:e(t.content,{...t.values})}),(0,C.jsx)(a.m,{className:"pt-1",children:Object.keys(x).map((t=>{var r;return(0,s.createElement)(n.R,{...x[t].holder,key:x[t].holder.label,label:e(x[t].holder.label),text:e(null!==(r=x[t].holder.text)&&void 0!==r?r:"",{...x[t].holder.values}),advanced:(0,C.jsx)(a.m,{className:"max-w-96",children:(0,C.jsxs)(y.Z,{label:e("views.realtime.charts.".concat(t,".advanced.panels.butterworth_filter.title")),embedded:!0,children:[(0,C.jsxs)(a.m,{className:"flex flex-col md:flex-row gap-4",children:[(0,C.jsx)(S.p,{onValueChange:e=>_(t,!0,Number(e)),defaultValue:.1,type:"number",disabled:x[t].chart.filter.enabled,numberLimit:{max:100,min:.1},label:e("views.realtime.charts.".concat(t,".advanced.panels.butterworth_filter.low_corner_freq"))}),(0,C.jsx)(S.p,{onValueChange:e=>_(t,!1,Number(e)),defaultValue:10,type:"number",disabled:x[t].chart.filter.enabled,numberLimit:{max:100,min:.1},label:e("views.realtime.charts.".concat(t,".advanced.panels.butterworth_filter.high_corner_freq"))})]}),(0,C.jsx)(v.$,{label:e("views.realtime.charts.".concat(t,".advanced.panels.butterworth_filter.").concat(x[t].chart.filter.enabled?"disable_filter":"enable_filter")),className:"bg-indigo-600 hover:bg-indigo-700",onClick:()=>{return e=t,E((t=>({...t,[e]:{...t[e],chart:{...t[e].chart,filter:{...t[e].chart.filter,enabled:!t[e].chart.filter.enabled}}}})));var e}})]})})},(0,C.jsx)(o.t,{...x[t].chart,boost:!0,lineWidth:1,tooltip:!0,zooming:!0,animation:!1,tickPrecision:1,tickInterval:100,height:N}))}))})]})}}}]);