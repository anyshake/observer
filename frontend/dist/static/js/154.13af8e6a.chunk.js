"use strict";(self.webpackChunksrc=self.webpackChunksrc||[]).push([[154],{1385:(e,t,s)=>{s.d(t,{A:()=>a});s(9950);const a=s.p+"static/media/xmark-solid.33c889ee6afa3ed57684011608af6238.svg"},25242:(e,t,s)=>{s.d(t,{$:()=>o});var a=s(44414);const o=e=>{const{className:t,label:s,onClick:o}=e;return(0,a.jsx)("button",{className:"w-full text-white font-medium text-sm shadow-lg rounded-lg py-2 ".concat(null!==t&&void 0!==t?t:""),onClick:o,children:s})}},40088:(e,t,s)=>{s.d(t,{t:()=>h});var a=s(93461),o=s.n(a),l=s(49027),n=s.n(l),r=s(11274),i=s(9950),c=s(67818),d=s(44414);const h=(0,i.forwardRef)(((e,t)=>{const s=.65*window.devicePixelRatio,{boost:a,title:l,series:h,height:u,legend:m,tooltip:v,zooming:f,animation:p,lineWidth:b,tickInterval:x,tickPrecision:g,lineColor:y,backgroundColor:w}=e,[_,C]=(0,i.useState)(!1);(0,i.useEffect)((()=>{C((()=>{if(window.WebGLRenderingContext){const e=document.createElement("canvas");return["webgl","experimental-webgl","webgl2","moz-webgl","webkit-3d"].some((t=>{try{return!!e.getContext(t)}catch(s){return!1}}))}return!1})())}),[]);const[S,j]=(0,i.useState)({chart:{zooming:f?{type:"x"}:{},marginTop:20,height:u,animation:p,backgroundColor:w},xAxis:{labels:{style:{color:"#fff"},format:"{value:%H:%M:%S}"},type:"datetime",tickColor:"#fff",lineColor:y},yAxis:{labels:{style:{color:"#fff"},format:g?"{value:".concat(g,"f}"):"{value:0.2f}"},title:{text:""},opposite:!0,lineColor:y,tickInterval:x},tooltip:{enabled:v,followPointer:!0,followTouchMove:!0,xDateFormat:"%Y-%m-%d %H:%M:%S",padding:12},legend:{enabled:m,itemStyle:{color:"#fff"}},plotOptions:{series:{lineWidth:b,turboThreshold:a?10:0,boostThreshold:a?1:0,states:{hover:{enabled:!1}}}},title:{text:l,style:{color:"#fff",fontSize:"10px",fontWeight:"normal"}},boost:{enabled:_,pixelRatio:s},accessibility:{enabled:!1},credits:{enabled:!1},time:{useUTC:!1},series:[h]}),{t:A}=(0,c.Bd)();return(0,i.useEffect)((()=>{n()(o())}),[]),(0,i.useEffect)((()=>{o().setOptions({lang:{resetZoom:A("components.chart.reset_zoom"),resetZoomTitle:A("components.chart.reset_zoom_title")}})}),[A]),(0,i.useEffect)((()=>{j((e=>({...e,chart:{...e.chart,height:u},title:{...e.title,text:l},boost:{...e.boost,enabled:_}})))}),[u,l,_]),(0,d.jsx)(r.HighchartsReact,{ref:t,options:S,highcharts:o()})}))},95660:(e,t,s)=>{s.d(t,{l:()=>p});var a=s(96583),o=s(40033),l=s(28170),n=s(6493),r=s(29925),i=s(25979),c=s(3788),d=s(95383),h=s(44322),u=s(79739),m=s(10226),v=s(9950),f=s(44414);const p=e=>{var t;const{open:s,title:p,content:b,cancelText:x,submitText:g,placeholder:y,defaultValue:w,inputType:_,onSubmit:C,onClose:S,selectOptions:j}=e,[A,N]=(0,v.useState)(""),[k,E]=(0,v.useState)("");return(0,v.useEffect)((()=>{var e;E(null!==(e=null===j||void 0===j?void 0:j[0].value)&&void 0!==e?e:"")}),[j]),(0,f.jsxs)(a.A,{onClose:S,open:s,children:[(0,f.jsx)(o.A,{children:p}),(0,f.jsxs)(l.A,{children:[b&&(0,f.jsx)(n.A,{children:b}),(0,f.jsx)(r.A,{autoFocus:!0,fullWidth:!0,className:"mt-8",type:_,label:y,defaultValue:w,style:{display:"select"!==_?"block":"none"},onChange:e=>{let{target:t}=e;N(t.value)}}),(0,f.jsxs)(i.A,{sx:{my:2},style:{display:"select"===_?"block":"none"},children:[(0,f.jsx)(c.A,{children:y}),(0,f.jsx)(d.A,{fullWidth:!0,label:y,onChange:e=>{let{target:t}=e;E(t.value)},defaultValue:null!==(t=null===j||void 0===j?void 0:j[0].value)&&void 0!==t?t:"",children:null===j||void 0===j?void 0:j.map((e=>{let{value:t,label:s}=e;return(0,f.jsx)(h.A,{value:t,children:s},t)}))})]})]}),(0,f.jsxs)(u.A,{children:[x&&(0,f.jsx)(m.A,{onClick:S,children:x}),(0,f.jsx)(m.A,{onClick:()=>{C&&C("select"===_?k:A)},children:g})]})]})}},53768:(e,t,s)=>{s.d(t,{h:()=>i,R:()=>c});var a=s(9950);const o=s.p+"static/media/ellipsis-solid.e3aced2a80c2b888104322b1ae60b47f.svg";const l=s.p+"static/media/square-caret-up-solid.0573794ec033f5ce25c1076e3ac596e3.svg";var n=s(1385),r=s(44414);let i=function(e){return e[e.COLLAPSE_DISABLE=0]="COLLAPSE_DISABLE",e[e.COLLAPSE_SHOW=1]="COLLAPSE_SHOW",e[e.COLLAPSE_HIDE=2]="COLLAPSE_HIDE",e}({});const c=e=>{const{label:t,text:s,children:c,collapse:d,advanced:h}=e,[u,m]=(0,a.useState)(!1),[v,f]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=null!==d&&void 0!==d?d:i.COLLAPSE_DISABLE;m(e===i.COLLAPSE_HIDE)}),[d]);const p=(null!==d&&void 0!==d?d:i.COLLAPSE_DISABLE)!==i.COLLAPSE_DISABLE;return(0,r.jsxs)("div",{className:"mb-4 flex flex-col rounded-xl text-gray-700 shadow-lg",children:[(0,r.jsx)("div",{className:"mx-4 rounded-lg overflow-hidden shadow-lg",children:c}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("h6",{className:"text-md font-bold text-gray-800 flex ".concat(p?"cursor-pointer select-none":""),onClick:()=>{p&&m(!u)},children:[p&&(0,r.jsx)("img",{className:"mx-1 ".concat(u?"rotate-180":""),src:l,alt:""}),t]}),s&&!u&&(0,r.jsx)("div",{className:"text-md pt-2",children:s.split("\n").map((e=>(0,r.jsx)("div",{children:e},e)))}),h&&(0,r.jsxs)("div",{className:"mt-2 space-y-2 ".concat(u?"hidden":"block"),children:[(0,r.jsxs)("div",{className:"mx-1 cursor-pointer",onClick:()=>{f(!v)},children:[(0,r.jsx)("img",{className:"size-4 ".concat(v?"hidden":"block"),src:o,alt:""}),(0,r.jsx)("img",{className:"size-4 ".concat(v?"block":"hidden"),src:n.A,alt:""})]}),(0,r.jsx)("div",{className:v?"block":"hidden",children:h})]})]})]})}},67780:(e,t,s)=>{s.d(t,{p:()=>l});var a=s(29925),o=s(44414);const l=e=>{const{label:t,disabled:s,className:l,defaultValue:n,numberLimit:r,type:i,onValueChange:c}=e;return(0,o.jsx)(a.A,{size:"small",type:i,label:t,disabled:s,onChange:e=>{let{target:t}=e;if(!c)return;const{value:s}=t;if("number"===i){const e=Number(s);if(isNaN(e))return void c(n);if(r){const{max:t,min:s}=r;if(e>t||e<s)return void c(n)}c(e)}else c(s)},defaultValue:n,className:"w-full ".concat(null!==l&&void 0!==l?l:""),InputLabelProps:{shrink:!0}})}},51682:(e,t,s)=>{s.d(t,{J:()=>o});var a=s(44414);const o=e=>{const{className:t,icon:s,label:o,value:l,unit:n,color:r}=e;return(0,a.jsx)("div",{className:"w-full p-2 ".concat(null!==t&&void 0!==t?t:""),children:(0,a.jsxs)("div",{className:"flex flex-row bg-gradient-to-r rounded-md p-4 shadow-xl ".concat(r?"from-indigo-500 via-purple-500 to-pink-500":"bg-gray-50 hover:bg-gray-100 transition-all"),children:[s&&(0,a.jsx)("img",{className:"bg-white p-2 rounded-md w-8 h-8 md:w-12 md:h-12 self-center",src:s,alt:""}),(0,a.jsxs)("div",{className:"flex flex-col flex-grow ".concat(s?"ml-5":""),children:[(0,a.jsx)("div",{className:"text-sm whitespace-nowrap ".concat(r?"text-gray-50":"text-gray-600"),children:o}),(0,a.jsx)("div",{className:"text-md font-medium flex-nowrap ".concat(r?"text-gray-100":"text-gray-800"),children:"".concat(l," ").concat(null!==n&&void 0!==n?n:"")})]})]})})}},60898:(e,t,s)=>{s.d(t,{Z:()=>o});var a=s(44414);const o=e=>{const{embedded:t,className:s,label:o,sublabel:l,children:n}=e;return(0,a.jsx)("div",{className:"w-full text-gray-800",children:(0,a.jsxs)("div",{className:"flex flex-col shadow-lg rounded-lg",children:[(0,a.jsxs)("div",{className:"px-4 py-3 font-bold",children:[l&&(0,a.jsx)("h6",{className:"text-gray-500 text-xs",children:l}),(0,a.jsx)("h2",{className:t?"text-md":"text-lg",children:o})]}),(0,a.jsx)("div",{className:"p-4 m-2 flex flex-col justify-center gap-4 ".concat(null!==s&&void 0!==s?s:""),children:n})]})})}},2074:(e,t,s)=>{s.d(t,{l:()=>v});var a=s(96583),o=s(88060),l=s(83239),n=s(82053),r=s(10226),i=s(249),c=s(32610),d=s(57357),h=s(83563),u=s(74745),m=s(44414);const v=e=>{const{title:t,open:s,options:v,onClose:f,onSelect:p}=e;return(0,m.jsxs)(a.A,{fullWidth:!0,onClose:f,open:s,children:[(0,m.jsx)(o.A,{className:"bg-violet-500",sx:{position:"relative"},children:(0,m.jsxs)(l.A,{children:[(0,m.jsx)(n.A,{sx:{mt:1,ml:1,flex:1},variant:"h6",children:t}),(0,m.jsx)(r.A,{autoFocus:!0,color:"inherit",onClick:f,children:"X"})]})}),(0,m.jsx)(i.A,{children:!(null===v||void 0===v||!v.length)&&v.map((e=>e.length>1&&(0,m.jsxs)("div",{children:[(0,m.jsx)(c.Ay,{children:(0,m.jsx)(d.A,{onClick:()=>{p&&p(e[1])},children:(0,m.jsx)(h.A,{primary:e[0],secondary:e[3===e.length?2:1].split("\n").map((e=>(0,m.jsxs)("span",{children:[e,(0,m.jsx)("br",{})]},e)))})})}),(0,m.jsx)(u.A,{})]},e[1])))})]})}},71359:(e,t,s)=>{s.d(t,{w:()=>o});var a=s(35887);const o=function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;arguments.length>1&&void 0!==arguments[1]&&arguments[1]?a.Ay.error(e,{duration:t}):a.Ay.success(e,{duration:t})}},28418:(e,t,s)=>{s.d(t,{U:()=>a});const a=(e,t)=>{const s=[];for(let a=0;a<e.length;a++)a?s.push((e[a]-e[a-1])/(t/1e3)):s.push(0);return s}},7678:(e,t,s)=>{s.d(t,{W:()=>l,z:()=>o});var a=s(96004);let o=function(e){return e[e.LOW_PASS=0]="LOW_PASS",e[e.HIGH_PASS=1]="HIGH_PASS",e[e.BAND_PASS=2]="BAND_PASS",e}({});const l=(e,t)=>{const{passbandType:s,poles:l,sampleRate:n,lowFreqCorner:r,highFreqCorner:i}=t;let c;c=s===o.LOW_PASS?a.com.oregondsp.signalProcessing.filter.iir.PassbandType.LOWPASS:s===o.HIGH_PASS?a.com.oregondsp.signalProcessing.filter.iir.PassbandType.HIGHPASS:a.com.oregondsp.signalProcessing.filter.iir.PassbandType.BANDPASS;const d=new a.com.oregondsp.signalProcessing.filter.iir.Butterworth(l,c,r,i,1/n),h=new Float32Array(e);return d.filterInPlace(h),Array.from(h)}},76969:(e,t,s)=>{s.d(t,{N:()=>a});const a=(e,t)=>{const s=[];for(const a of e)s.push(a/t);return s}},27156:(e,t,s)=>{s.d(t,{i:()=>a});const a=(e,t,s)=>{const a=2**(t-1),o=[];for(const l of e)o.push(s/a*l);return o}},42105:(e,t,s)=>{s.d(t,{D:()=>o});var a=s(43974);const o=e=>{const t=new Date(e);return(0,a.A)(t,"yyyy-MM-dd HH:mm:ss")}},67502:(e,t,s)=>{s.d(t,{a:()=>a});const a=async e=>{var t;const s=null!==(t=navigator.clipboard)&&void 0!==t?t:{writeText:e=>{const t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}};return!!s&&(await s.writeText(e),!0)}},97154:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var a=s(9950),o=s(67818),l=s(82569),n=s(42074),r=s(25242),i=s(40088),c=s(55297),d=s(95660),h=s(53768),u=s(67780),m=s(51682),v=s(60898),f=s(2074),p=s(47775),b=s(65869),x=s(81831),g=s(87403),y=s(43396),w=s(69200),_=s(82537),C=s(34638),S=s(44414);const j=e=>{const{label:t,onChange:s,value:a,defaultValue:o,currentLocale:l}=e,n=Object.entries(_).reduce(((e,t)=>{let[s,a]=t;return e[s]=a,e}),{}),r=Object.entries(C).reduce(((e,t)=>{let[s,a]=t;return e[s]=a,e}),{});let i=l.replaceAll(/[^a-z0-9]/gi,"");n[i]&&r[i]||(i="enUS");const c=(0,p.A)({},n[i]),d=Intl.DateTimeFormat().resolvedOptions().timeZone;return(0,S.jsx)(b.A,{theme:c,children:(0,S.jsx)(x.$,{dateAdapter:w.h,adapterLocale:r[i],children:(0,S.jsx)(g.K,{format:"yyyy-MM-dd HH:mm:ss",className:"w-full",timezone:"system",views:["year","month","day","hours","minutes","seconds"],viewRenderers:{hours:y.Zo,minutes:y.Zo,seconds:y.Zo},onChange:e=>{const t=new Date(null!==e&&void 0!==e?e:0).getTime();s(isNaN(t)?0:t)},slotProps:{field:{clearable:!0}},label:"".concat(t," - ").concat(d),defaultValue:o,value:null!==a&&void 0!==a?a:0,ampm:!1})})})};var A=s(19325),N=s(41237),k=s(35887);const E=async function(e,t,s,a){if(!(!(arguments.length>4&&void 0!==arguments[4])||arguments[4]))return await k.Ay.promise(e,{loading:t,success:s,error:a});try{return await k.Ay.promise(e,{loading:t,success:s,error:a})}catch{}};var L=s(71359),P=s(38526),T=s(7678),H=s(42105),O=s(67502);const D=(e,t,s)=>{let{network:a,station:o,location:l}=s;const n=new Date(e);return"".concat(n.getUTCFullYear(),".").concat((e=>{const t=new Date(e.getUTCFullYear(),0,0),s=e.getTime()-t.getTime();return Math.floor(s/864e5)})(n).toString().padStart(3,"0"),".").concat(n.getUTCHours().toString().padStart(2,"0"),".").concat(n.getUTCMinutes().toString().padStart(2,"0"),".").concat(n.getUTCSeconds().toString().padStart(2,"0"),".").concat(n.getUTCMilliseconds().toString().padStart(4,"0"),".").concat(a.slice(0,2),".").concat(o.slice(0,5),".").concat(l.slice(0,2),".").concat(t,".D.sac")};var F=s(64192),z=s(28418),R=s(76969),q=s(27156);const I=e=>{var t,s,p,b,x,g;const{t:y}=(0,o.Bd)(),{station:w}=(0,l.d4)((e=>{let{station:t}=e;return t})),{duration:_}=(0,l.d4)((e=>{let{duration:t}=e;return t})),[C,k]=(0,a.useState)(!w.initialized);(0,a.useEffect)((()=>{k(!w.initialized)}),[w.initialized]);const I=Date.now(),[W,M]=(0,n.ok)(),[B,Z]=(0,a.useState)({start:W.has("start")?Number(W.get("start")):I-1e3*_,end:W.has("end")?Number(W.get("end")):I}),V=(e,t)=>Z((s=>t?{...s,end:e}:{...s,start:e})),[U,$]=(0,a.useState)({open:!1,inputType:"select"}),[G,Y]=(0,a.useState)({open:!1}),J=()=>{Y({...G,open:!1})},[X,K]=(0,a.useState)({ehz:{label:"views.history.labels.ehz_detail.label",value:"-"},ehe:{label:"views.history.labels.ehe_detail.label",value:"-"},ehn:{label:"views.history.labels.ehn_detail.label",value:"-"}}),[Q,ee]=(0,a.useState)({ehz:{holder:{collapse:h.h.COLLAPSE_HIDE,label:"views.history.charts.ehz.label",text:"views.history.charts.ehz.text"},chart:{buffer:[],backgroundColor:"#d97706",filter:{enabled:!1},ref:(0,a.useRef)(null),series:{name:"EHZ",type:"line",color:"#f1f5f9"}}},ehe:{holder:{collapse:h.h.COLLAPSE_SHOW,label:"views.history.charts.ehe.label",text:"views.history.charts.ehe.text"},chart:{buffer:[],backgroundColor:"#10b981",filter:{enabled:!1},ref:(0,a.useRef)(null),series:{name:"EHE",type:"line",color:"#f1f5f9"}}},ehn:{holder:{collapse:h.h.COLLAPSE_SHOW,label:"views.history.charts.ehn.label",text:"views.history.charts.ehn.text"},chart:{buffer:[],backgroundColor:"#0ea5e9",filter:{enabled:!1},ref:(0,a.useRef)(null),series:{name:"EHN",type:"line",color:"#f1f5f9"}}}}),te=(e,t,s)=>ee((a=>({...a,[e]:{...a[e],chart:{...a[e].chart,filter:{...a[e].chart.filter,[t?"lowCorner":"highCorner"]:s}}}}))),se=async()=>{const{start:e,end:t}=B;if(!e||!t||e>=t)return void(0,L.w)(y("views.history.toasts.duration_error"),!0);const{backend:s}=A.DR,a={start:e,end:t,channel:"",format:"json"},o=await E((0,P.c)({backend:s,payload:a,timeout:120,throwError:!0,endpoint:A.DR.endpoints.history}),y("views.history.toasts.is_fetching_waveform"),y("views.history.toasts.fetch_waveform_success"),y("views.history.toasts.fetch_waveform_error"));((e,t)=>{if(null===e||void 0===e||!e.data)return;const{adc:s}=F.A.getState().adc,{geophone:a}=F.A.getState().geophone;t((t=>(Object.keys(t).forEach((o=>{if(!e.data.every((e=>o in e)))return;const l=e.data.map((e=>e[o])).map((e=>(0,q.i)(e,s.resolution,s.fullscale))).map((e=>{const t=a.sensitivity/100;return(0,R.N)(e,t)})),n=l.map((e=>{const t=1e3/e.length;return(0,z.U)(e,t)})),r=l.flat().reduce(((e,t)=>Math.max(Math.abs(e),Math.abs(t))),0),i=n.flat().reduce(((e,t)=>Math.max(Math.abs(e),Math.abs(t))),0);t[o]={...t[o],values:{pgv:r.toFixed(5),pga:i.toFixed(5)},value:"views.history.labels.".concat(o,"_detail.value")}})),t)))})(o,K),((e,t)=>{null!==e&&void 0!==e&&e.data&&t((t=>(Object.keys(t).forEach((s=>{if(!e.data.every((e=>s in e)))return;const a=e.data.map((e=>{let{ts:t,...a}=e;return{data:a[s],ts:t}}));t[s].chart.buffer=a;const{enabled:o,lowCorner:l,highCorner:n}=t[s].chart.filter,{lowFreqCorner:r,highFreqCorner:i}={lowFreqCorner:null!==l&&void 0!==l?l:.1,highFreqCorner:null!==n&&void 0!==n?n:10};t[s].chart={...t[s].chart,title:o?"Band pass [".concat(r,"-").concat(i," Hz]"):""};const c=a.map((e=>{let{ts:t,data:s}=e;const a=o?(0,T.W)(s,{poles:4,lowFreqCorner:r,highFreqCorner:i,sampleRate:s.length,passbandType:T.z.BAND_PASS}):s,l=1e3/a.length;return a.map(((e,s)=>[t+l*s,e]))})).reduce(((e,t)=>e.concat(t)),[]),{current:d}=t[s].chart.ref;if(d){const{series:e}=d.chart;e[0].setData(c,!0,!1,!1)}})),t)))})(o,ee)},{locale:ae}=e,{fallback:oe}=N.X;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(c.m,{className:"my-6 gap-4 grid lg:grid-cols-2 ".concat(C?"cursor-progress":""),children:[(0,S.jsxs)(v.Z,{label:y("views.history.panels.query_history"),children:[(0,S.jsx)(j,{value:B.start,currentLocale:null!==ae&&void 0!==ae?ae:oe,label:y("views.history.time_pickers.start_time"),onChange:e=>V(e,!1)}),(0,S.jsx)(j,{value:B.end,currentLocale:null!==ae&&void 0!==ae?ae:oe,label:y("views.history.time_pickers.end_time"),onChange:e=>V(e,!0)}),(0,S.jsx)(r.$,{className:"bg-indigo-700 hover:bg-indigo-800 ".concat(C?"cursor-wait":""),onClick:async()=>{C||(k(!0),await se(),k(!1))},label:y("views.history.buttons.query_waveform")}),(0,S.jsx)(r.$,{className:"bg-green-700 hover:bg-green-800 ".concat(C?"cursor-wait":""),onClick:()=>{C||(k(!0),(()=>{const{start:e,end:t}=B;if(!e||!t||e>=t)return void(0,L.w)(y("views.history.toasts.duration_error"),!0);const s=async s=>{$((e=>({...e,open:!1})));const{backend:a}=A.DR,o={start:e,end:t,channel:s,format:"sac"},l=D(e,s,w);await E((0,P.c)({backend:a,payload:o,timeout:120,throwError:!0,endpoint:A.DR.endpoints.history,blobOptions:{fileName:l}}),y("views.history.toasts.is_exporting_sac"),y("views.history.toasts.export_sac_success"),y("views.history.toasts.export_sac_error"))};$((e=>({...e,open:!0,selectOptions:[{label:"EHZ",value:"EHZ"},{label:"EHE",value:"EHE"},{label:"EHN",value:"EHN"}],onSubmit:s,title:"views.history.forms.choose_channel.title",cancelText:"views.history.forms.choose_channel.cancel",submitText:"views.history.forms.choose_channel.submit",placeholder:"views.history.forms.choose_channel.placeholder"})))})(),k(!1))},label:y("views.history.buttons.query_sac_file")}),(0,S.jsx)(r.$,{className:"bg-yellow-700 hover:bg-yellow-800 ".concat(C?"cursor-wait":""),onClick:async()=>{C||(k(!0),await(async()=>{const{backend:e}=A.DR,t=await E((0,P.c)({backend:e,payload:{source:"show"},timeout:30,throwError:!0,endpoint:A.DR.endpoints.trace}),y("views.history.toasts.is_fetching_source"),y("views.history.toasts.fetch_source_success"),y("views.history.toasts.fetch_source_error"));if(null===t||void 0===t||!t.data)return;const s=async t=>{$((e=>({...e,open:!1})));const s=await E((0,P.c)({backend:e,timeout:60,throwError:!0,payload:{source:t},endpoint:A.DR.endpoints.trace}),y("views.history.toasts.is_fetching_events"),y("views.history.toasts.fetch_events_success"),y("views.history.toasts.fetch_events_error"));if(null===s||void 0===s||!s.data)return;const a=e=>{Y((e=>({...e,open:!1})));const[t,s]=e.split("|").map(Number);Z({start:t,end:s}),(0,L.w)(y("views.history.toasts.event_select_success"))},o=s.data.map((e=>{let{distance:t,magnitude:s,region:a,event:o,timestamp:l,depth:n,estimation:r}=e;return[a,"".concat(Math.round(l+1e3*r.p-500*_),"|").concat(Math.round(l+1e3*r.s+500*_)),y("views.history.selects.choose_event.template",{event:o,time:(0,H.D)(l),magnitude:s.toFixed(1),distance:t.toFixed(1),p_wave:r.p.toFixed(1),s_wave:r.s.toFixed(1),depth:-1!==n?n.toFixed(1):"-"})]}));Y((e=>({...e,open:!0,options:o,onClose:J,onSelect:a,title:"views.history.selects.choose_event.title"})))};$((e=>({...e,open:!0,selectOptions:t.data.sort(((e,t)=>"name"in e&&"value"in e&&"name"in t&&"value"in t?e.name.localeCompare(t.name):0)).map((e=>"name"in e&&"value"in e?{label:e.name,value:e.value}:{label:"",value:""})),onSubmit:s,title:"views.history.forms.choose_source.title",cancelText:"views.history.forms.choose_source.cancel",submitText:"views.history.forms.choose_source.submit",placeholder:"views.history.forms.choose_source.placeholder"})))})(),k(!1))},label:y("views.history.buttons.query_source")}),(0,S.jsx)(r.$,{className:"bg-cyan-700 hover:bg-cyan-800",onClick:async()=>{const{start:e,end:t}=B;if(!e||!t||e>=t)return void(0,L.w)(y("views.history.toasts.duration_error"),!0);const s=new URLSearchParams;s.set("start",String(e)),s.set("end",String(t)),M(s);const a=window.location.href,o=await(0,O.a)(a);(0,L.w)(y(o?"views.history.toasts.copy_link_success":"views.history.toasts.copy_link_error"),!o)},label:y("views.history.buttons.get_share_link")})]}),(0,S.jsx)(v.Z,{className:"",label:y("views.history.panels.analyze_history"),children:Object.values(X).map((e=>{let{label:t,value:s,values:o,...l}=e;return(0,a.createElement)(m.J,{...l,key:t,label:y(t),value:y(s,o)})}))}),(0,S.jsx)(d.l,{...U,onClose:()=>{$({...U,open:!1})},title:y(null!==(t=U.title)&&void 0!==t?t:""),cancelText:y(null!==(s=U.cancelText)&&void 0!==s?s:""),submitText:y(null!==(p=U.submitText)&&void 0!==p?p:""),placeholder:y(null!==(b=U.placeholder)&&void 0!==b?b:""),content:y(null!==(x=U.content)&&void 0!==x?x:"",{...U.values})}),(0,S.jsx)(f.l,{...G,onClose:J,title:y(null!==(g=G.title)&&void 0!==g?g:"")})]}),Object.keys(Q).map((e=>{var t,s;return(0,S.jsx)(h.R,{text:y(null!==(t=Q[e].holder.text)&&void 0!==t?t:""),label:y(null!==(s=Q[e].holder.label)&&void 0!==s?s:""),advanced:(0,S.jsx)(c.m,{className:"max-w-96",children:(0,S.jsxs)(v.Z,{label:y("views.history.charts.".concat(e,".advanced.panels.butterworth_filter.title")),embedded:!0,children:[(0,S.jsxs)(c.m,{className:"flex flex-col md:flex-row gap-4",children:[(0,S.jsx)(u.p,{onValueChange:t=>te(e,!0,Number(t)),defaultValue:.1,type:"number",disabled:Q[e].chart.filter.enabled,numberLimit:{max:100,min:.1},label:y("views.history.charts.".concat(e,".advanced.panels.butterworth_filter.low_corner_freq"))}),(0,S.jsx)(u.p,{onValueChange:t=>te(e,!1,Number(t)),defaultValue:10,type:"number",disabled:Q[e].chart.filter.enabled,numberLimit:{max:100,min:.1},label:y("views.history.charts.".concat(e,".advanced.panels.butterworth_filter.high_corner_freq"))})]}),(0,S.jsx)(r.$,{label:y("views.history.charts.".concat(e,".advanced.panels.butterworth_filter.").concat(Q[e].chart.filter.enabled?"disable_filter":"enable_filter")),className:"bg-indigo-600 hover:bg-indigo-700",onClick:()=>{return t=e,void ee((e=>{const s=!e[t].chart.filter.enabled,{lowCorner:a,highCorner:o}=e[t].chart.filter,{lowFreqCorner:l,highFreqCorner:n}={lowFreqCorner:null!==a&&void 0!==a?a:.1,highFreqCorner:null!==o&&void 0!==o?o:10},r=e[t].chart.buffer.map((e=>{let{ts:t,data:a}=e;const o=s?(0,T.W)(a,{poles:4,lowFreqCorner:l,highFreqCorner:n,sampleRate:a.length,passbandType:T.z.BAND_PASS}):a,r=1e3/o.length;return o.map(((e,s)=>[t+r*s,e]))})).reduce(((e,t)=>e.concat(t)),[]),{current:i}=e[t].chart.ref;if(i){const{series:e}=i.chart;e[0].setData(r,!0,!1,!1)}const c={...e[t],chart:{...e[t].chart,filter:{...e[t].chart.filter,enabled:s},title:s?"Band pass [".concat(l,"-").concat(n," Hz]"):""}};return{...e,[t]:c}}));var t}})]})}),children:(0,S.jsx)(i.t,{...Q[e].chart,height:300,boost:!0,lineWidth:1,tooltip:!0,zooming:!0,animation:!0,tickPrecision:1,tickInterval:100})},Q[e].holder.label)}))]})}}}]);