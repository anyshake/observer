"use strict";(self.webpackChunkobserver=self.webpackChunkobserver||[]).push([[10],{1653:function(e,t,a){a.d(t,{Z:function(){return l}});var n=a(5671),r=a(3144),o=a(136),c=a(7277),s=a(7313),i=a(6417),l=function(e){(0,o.Z)(a,e);var t=(0,c.Z)(a);function a(){return(0,n.Z)(this,a),t.apply(this,arguments)}return(0,r.Z)(a,[{key:"render",value:function(){var e=this.props,t=e.className,a=e.icon,n=e.label,r=e.value,o=e.unit,c=e.color;return(0,i.jsx)("div",{className:"w-full p-2 ".concat(t),children:(0,i.jsxs)("div",{className:"flex flex-row bg-gradient-to-r rounded-md p-4 shadow-xl ".concat(c?"from-indigo-500 via-purple-500 to-pink-500":"bg-slate-50 hover:bg-slate-100"),children:[a&&(0,i.jsx)("img",{className:"bg-white p-2 rounded-md w-8 h-8 md:w-12 md:h-12 self-center",src:a,alt:""}),(0,i.jsxs)("div",{className:"flex flex-col flex-grow ".concat(a&&"ml-5"),children:[(0,i.jsx)("div",{className:"text-sm whitespace-nowrap ".concat(c?"text-gray-50":"text-gray-600"),children:n}),(0,i.jsxs)("div",{className:"text-md font-medium ".concat(c?"text-gray-100":"text-gray-800"),children:[r,(0,i.jsx)("span",{className:"text-lg px-2",children:o})]})]})]})})}}]),a}(s.Component)},4447:function(e,t,a){a.r(t),a.d(t,{default:function(){return Q}});var n=a(1413),r=a(4165),o=a(5861),c=a(5671),s=a(3144),i=a(136),l=a(7277),u=a(7313),d=a(922),f=a(3534),h=a(5097),m=a(501),p=a(318),v=a(1653),Z=a(4656),x=a(5608),g=a(3676),b=a(1109),y=a(19),j=a(4580),w=a(8153),k=a(9062);var C=a.p+"static/media/location-dot-solid.763794361437464c10451de38cd290f7.svg",N=(a(3331),a(7248)),z=a.n(N),D=a(6417),A=function(e){(0,i.Z)(a,e);var t=(0,l.Z)(a);function a(e){var n;return(0,c.Z)(this,a),(n=t.call(this,e)).state={map:(0,u.createRef)()},n}return(0,s.Z)(a,[{key:"componentDidUpdate",value:function(){var e,t=this.props,a=t.center,n=t.flyTo,r=t.zoom,o=null===(e=this.state.map)||void 0===e?void 0:e.current;o&&n&&(null===o||void 0===o||o.flyTo(a,r))}},{key:"render",value:function(){var e=this.props,t=e.className,a=e.minZoom,n=e.maxZoom,r=e.center,o=e.zoom,c=e.tile,s=e.marker,i=e.dragging,l=e.zoomControl,u=this.state.map,d=new(z().Icon)({iconUrl:C,iconAnchor:[13,28],iconSize:[18,25]});return(0,D.jsxs)(j.h,{ref:u,className:"z-0 w-full ".concat(t),zoomControl:l,attributionControl:!1,scrollWheelZoom:!1,doubleClickZoom:!1,dragging:i,maxZoom:n,minZoom:a,center:r,zoom:o,style:{cursor:"default"},children:[(0,D.jsx)(w.I,{url:c}),s&&(0,D.jsx)(k.J,{position:s,icon:d})]})}}]),a}(u.Component),F=a(284);var S=a.p+"static/media/circle-check-solid.3fb46b8931cbbf9f966175f42b55a087.svg";var U=a.p+"static/media/bug-solid.7f781f9ddd35c29f11111e36602dcc87.svg";var E=a.p+"static/media/paper-plane-solid.e1f40db20eab51657c5490a69c103292.svg";var I=a.p+"static/media/circle-xmark-solid.ea0857c87457d25b161c3a37ad4e3845.svg";var T=a.p+"static/media/hourglass-half-solid.1e8dc3284939ca52c0fd542da1fbf89b.svg";var W=a.p+"static/media/clock-solid.23025348eaec720a2439930b37d677ee.svg",q=a(2468),G=a(4477),R=function(e){(0,i.Z)(a,e);var t=(0,l.Z)(a);function a(){return(0,c.Z)(this,a),t.apply(this,arguments)}return(0,s.Z)(a,[{key:"render",value:function(){var e=this.props,t=e.tag,a=e.timer,n=e.onData,r=e.onError,o=e.onFetch,c=e.children,s=e.retry,i=Array.isArray(c)?c:[c];return(0,D.jsx)(G.Z,{url:t,interval:a,promise:o,retryCount:s,onFailure:r,render:function(){return i},onSuccess:function(e){return n&&n(e),!0}})}}]),a}(u.Component),V=function(e){var t=e||{},a=t.error,n=t.message,r=(null===e||void 0===e?void 0:e.data)||{},o=r.uuid,c=r.station,s=r.uptime,i=r.os,l="\u8fde\u63a5\u5931\u8d25",u="\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u8bf7\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\u6216\u66f4\u6362\u7f51\u7edc";return a||(l="\u8fde\u63a5\u6210\u529f\uff1a".concat(c),u="".concat(n,"\n\n                \u670d\u52a1\u5668\u5728\u7ebf\u65f6\u957f ").concat(s," \u79d2\n\n                \u670d\u52a1\u5668\u91c7\u7528\u67b6\u6784 ").concat(i.arch,"/").concat(i.os,"\n\n                UUID\uff1a").concat(o,"\n")),{type:a?"error":"success",label:l,text:u}},J=a(7912),M=function(e,t){for(var a=0,n=["messages","errors","pushed","failures","queued","offset"];a<n.length;a++){var r=n[a],o=t.data.status;(0,J.Z)(e,"[tag:".concat(r,"]>value"),o[r])}return e},P=function(e,t){var a=t.data.location;return(0,n.Z)((0,n.Z)({},e),{},{area:(0,n.Z)((0,n.Z)({},e.area),{},{text:"\u6d4b\u7ad9\u7ecf\u5ea6\uff1a".concat(a.longitude," \xb0\n\n                \u6d4b\u7ad9\u7eac\u5ea6\uff1a").concat(a.latitude," \xb0\n\n                \u6d4b\u7ad9\u6d77\u62d4\uff1a").concat(a.altitude," m")}),instance:(0,n.Z)((0,n.Z)({},e.instance),{},{center:[a.latitude,a.longitude],marker:[a.latitude,a.longitude]})})},$=a(3651),B=function(e,t,a){for(var n=function(){var n,c,s=o[r],i=t.data[s].percent,l=[Date.now(),i],u=null===(n=e.find((function(e){return e.tag===s})))||void 0===n||null===(c=n.chart.series)||void 0===c?void 0:c.data,d=(0,$.Z)(u,l,a);(0,J.Z)(e,"[tag:".concat(s,"]>area>text"),"\u5f53\u524d\u5360\u7528\u7387\uff1a".concat(i.toFixed(2),"%")),(0,J.Z)(e,"[tag:".concat(s,"]>chart>series>data"),d)},r=0,o=["cpu","memory"];r<o.length;r++)n();return e},H=a(6135),K=a(7703),L=a(8146),O=function(e){(0,i.Z)(a,e);var t=(0,l.Z)(a);function a(e){var n;return(0,c.Z)(this,a),(n=t.call(this,e)).handleFetch=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,q.Z)({tag:t});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleError=function(){var e=V();n.setState({banner:e})},n.handleData=function(e){var t=e.error,a=V(e);if(!t){var r=e.data,o=r.adc,c=r.geophone,s=n.props,i=s.updateADC;(0,s.updateGeophone)(c),i(o);var l=P(n.state.map,e),u=M(n.state.labels,e),d=B(n.state.areas,e,120);n.setState({labels:u,areas:d,map:l})}n.setState({banner:a})},n.state={banner:{type:"warning",label:"\u6b63\u5728\u8fde\u63a5\u670d\u52a1\u5668",text:"\u8bf7\u7a0d\u7b49..."},labels:[{tag:"messages",label:"\u5df2\u89e3\u7801\u8baf\u606f\u91cf",value:"0",unit:"\u6761",icon:S,color:!0},{tag:"errors",label:"\u5e27\u9519\u8bef\u8baf\u606f\u91cf",value:"0",unit:"\u6761",icon:U,color:!0},{tag:"pushed",label:"\u5df2\u63a8\u9001\u8baf\u606f\u91cf",value:"0",unit:"\u6761",icon:E,color:!0},{tag:"failures",label:"\u63a8\u9001\u5931\u8d25\u8baf\u606f\u91cf",value:"0",unit:"\u6761",icon:I,color:!0},{tag:"queued",label:"\u7b49\u5f85\u63a8\u9001\u8baf\u606f\u91cf",value:"0",unit:"\u6761",icon:T,color:!0},{tag:"offset",label:"\u7cfb\u7edf\u65f6\u95f4\u504f\u79fb\u91cf",value:"0",unit:"\u79d2",icon:W,color:!0}],areas:[{tag:"cpu",area:{label:"CPU \u5360\u7528\u7387",text:"\u5f53\u524d\u5360\u7528\u7387\uff1a\u6b63\u5728\u83b7\u53d6\u4e2d"},chart:{backgroundColor:"#22c55e",lineWidth:5,height:250,series:{type:"line",color:"#fff",data:[]}}},{tag:"memory",area:{label:"RAM \u5360\u7528\u7387",text:"\u5f53\u524d\u5360\u7528\u7387\uff1a\u6b63\u5728\u83b7\u53d6\u4e2d"},chart:{backgroundColor:"#06b6d4",lineWidth:5,height:250,series:{type:"line",color:"#fff",data:[]}}}],map:{area:{label:"\u6d4b\u7ad9\u6240\u5728\u4f4d\u7f6e",text:"\u6b63\u5728\u52a0\u8f7d\u4f4d\u7f6e\u8d44\u8baf"},instance:{zoom:6,minZoom:3,maxZoom:7,flyTo:!0,center:[0,0],tile:"/tiles/{z}/{x}/{y}/tile.webp"}}},n}return(0,s.Z)(a,[{key:"render",value:function(){var e=this.state,t=e.banner,a=e.labels,r=e.areas,o=this.state.map,c=o.area,s=o.instance;return(0,D.jsxs)(Z.Z,{children:[(0,D.jsx)(d.Z,{}),(0,D.jsx)(f.Z,{}),(0,D.jsxs)(m.Z,{children:[(0,D.jsx)(h.Z,{}),(0,D.jsxs)(R,{retry:3,timer:1e3,tag:"station",onData:this.handleData,onFetch:this.handleFetch,onError:this.handleError,children:[(0,D.jsx)(p.Z,(0,n.Z)({},t)),(0,D.jsx)(b.Z,{layout:"flex",children:a.map((function(e,t){return(0,D.jsx)(v.Z,(0,n.Z)((0,n.Z)({},e),{},{className:"md:w-1/2 lg:w-1/3"}),t)}))}),(0,D.jsx)(b.Z,{layout:"grid",children:r.map((function(e,t){var a=e.area,r=e.chart;return(0,D.jsx)(x.Z,(0,n.Z)((0,n.Z)({},a),{},{children:(0,D.jsx)(g.Z,(0,n.Z)({},r))}),t)}))}),(0,D.jsx)(b.Z,{layout:"none",children:(0,D.jsx)(x.Z,{label:c.label,text:c.text,children:(0,D.jsx)(A,(0,n.Z)({className:"h-[400px]"},s))})})]})]}),(0,D.jsx)(F.Z,{}),(0,D.jsx)(y.Z,{})]})}}]),a}(u.Component),Q=(0,H.$j)((function(e){return(0,n.Z)({},e)}),{updateGeophone:L.V,updateADC:K.V})(O)}}]);